if(!hasInterface)exitwith{};[]spawn{waitUntil{!isNil"BIS_fnc_init"};waitUntil{!isNull player&&player==player};waitUntil{!(isNull(findDisplay 46))};waitUntil{!isNil"fasj"};bxmo=false;bxcd='lockCost'call trss;zpit='unlockCost'call trss;fasj=objNull;wmhw=objNull;if(isNil"oomw")then{oomw=false};[{if((_this select 0)isKindOf"Reammobox_F")then{if([]call apdk>=bxcd)then{format["<t color='#ff9c00'><img image='client\systems\logisticsAddons\icons\lock.paa' /> Lock Object [<t color='#FF0000'>-$%1</t>]</t>",bxcd]}else{format["<t color='#FF0000'><img image='client\systems\logisticsAddons\icons\lock.paa' /> Lock Object [-$%1]</t>",bxcd]}}else{"<t color='#ff9c00'><img image='client\systems\logisticsAddons\icons\lock.paa' /> Lock Object</t>"}},{isNull fasj&&!isNull wmhw&&!((_this select 0)getVariable['objectLocked',false])&&!oomw},{if(({(player distance(_x select 0))<=(_x select 2)}count(([[]call jdka,'buildingStore']call rewl)select 2))==0)then{if((getPosATL(_this select 0))select 2<=75)then{if((_this select 0)isKindOf"Reammobox_F"&&[]call apdk<bxcd)exitwith{hint"You do not have enough money to lock that."};[5,"Locking Object %1<br />- All bases must be accessible from the ground<br />- The person who locked the part must be online to prevent parts being unlocked<br />- A player friendly to the person who locked it must be within 100m to prevent parts being unlocked<br />- There is no rule against moving parts<br />- Using base parts as a weapon is against the rules<br />- For all server rules see the website",[(_this select 0)],{(_this select 0)setVariable['objectLocked',true,true];(_this select 0)setVariable['objectOwner',getPlayerUID player,true];ufqk=[player,_this select 0,false,vectorUp(_this select 0)];publicVariableServer"ufqk";if((_this select 0)isKindOf"Reammobox_F")then{bxcd call wpoe}}]call rpvv}else{hint"You can not lock parts above 50m"}}else{hint"You can not lock parts inside the building store radius"}},-1,5]call ewwn;[{if((_this select 0)isKindOf"Reammobox_F")then{format["<t color='#ff9c00'><img image='client\systems\logisticsAddons\icons\unlock.paa' /> Unlock Object [<t color='#00FF00'>+$%1</t>]</t>",zpit]}else{"<t color='#ff9c00'><img image='client\systems\logisticsAddons\icons\unlock.paa' /> Unlock Object</t>"}},{((_this select 0)getVariable['objectLocked',false])&&!oomw&&!bxmo},{bxmo=true;private["_euxs","_ueie","_qeoa","_oawd"];_euxs={[20,"Unlocking Object %1",[(_this select 0)],{(_this select 0)setVariable['objectLocked',false,true];bxmo=false;ufqk=[player,_this select 0,false];publicVariableServer"ufqk";if((_this select 0)isKindOf"Reammobox_F")then{zpit call vzid}},{bxmo=false}]call rpvv};_ueie=[(_this select 0)getVariable'objectOwner']call aerj;if(isNull _ueie||_ueie==player||_ueie in units group player)then{[(_this select 0)]call _euxs}else{[getPosATL(_this select 0),250,_ueie,[(_this select 0),_euxs],{_qeoa=_this select 0;_oawd=_this select 1 select 0;_euxs=_this select 1 select 1;if(_qeoa=="ENEMY")then{[_oawd]call _euxs}else{hint'The owner, or allied units are in the area. Eliminate them before moving this object.';bxmo=false}}]call dglh}},-1,5]call ewwn;['beforeMove',{!((_this select 0)getVariable['objectLocked',false])}]call u_fnc_nk;['releasedVehicle',{(_this select 1)call bvas}]call u_fnc_nk;['unloadedItem',{(_this select 0)call bvas}]call u_fnc_nk;['objectLoadedIn',{(_this select 0)call bvas}]call u_fnc_nk;['beforeReleaseObject',{if((_this select 0)isKindOf"Reammobox_F")then{[_this select 0,[0,0,0]]call fhcb};nil}]call u_fnc_nk};