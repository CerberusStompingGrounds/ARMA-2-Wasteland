if(!hasInterface)exitwith{};[]spawn{waitUntil{!isNil"bis_fnc_init"};waitUntil{!isNull player&&player==player};waitUntil{!(isNull(findDisplay 46))};waitUntil{!isNil"rtkt"};konq=false;crel='lockCost'call bdra;jped='unlockCost'call bdra;rtkt=objNull;orkb=objNull;if(isNil"lwyw")then{lwyw=false};[{if((_this select 0)isKindOf"Reammobox_F")then{if([]call pqoo>=crel)then{format["<t color='#ff9c00'><img image='client\systems\logisticsAddons\icons\lock.paa' /> Lock Object [<t color='#FF0000'>-$%1</t>]</t>",crel]}else{format["<t color='#FF0000'><img image='client\systems\logisticsAddons\icons\lock.paa' /> Lock Object [-$%1]</t>",crel]}}else{"<t color='#ff9c00'><img image='client\systems\logisticsAddons\icons\lock.paa' /> Lock Object</t>"}},{isNull rtkt&&!isNull orkb&&!((_this select 0)getVariable['objectLocked',false])&&!lwyw},{if(({(player distance(_x select 0))<=(_x select 2)}count(([[]call ifdi,'buildingStore']call uvzk)select 2))==0)then{if((getPosATL(_this select 0))select 2<=50)then{if((_this select 0)isKindOf"Reammobox_F"&&[]call pqoo<crel)exitwith{hint"You do not have enough money to lock that."};[10,"Locking Object %1<br />- All bases must be accessible from the ground<br />- The person who locked the part must be online to prevent parts being unlocked<br />- A player friendly to the person who locked it must be within 100m to prevent parts being unlocked<br />- There is no rule against moving parts<br />- Using base parts as a weapon is against the rules<br />- For all server rules see the website",[(_this select 0)],{(_this select 0)setVariable['objectLocked',true,true];(_this select 0)setVariable['objectOwner',getPlayerUID player,true];rwbh=[player,_this select 0,false,vectorUp(_this select 0)];publicVariableServer"rwbh";if((_this select 0)isKindOf"Reammobox_F")then{crel call tziw}}]call byng}else{hint"You can not lock parts above 50m"}}else{hint"You can not lock parts inside the building store radius"}},-1,5]call hzak;[{if((_this select 0)isKindOf"Reammobox_F")then{format["<t color='#ff9c00'><img image='client\systems\logisticsAddons\icons\unlock.paa' /> Unlock Object [<t color='#00FF00'>+$%1</t>]</t>",jped]}else{"<t color='#ff9c00'><img image='client\systems\logisticsAddons\icons\unlock.paa' /> Unlock Object</t>"}},{((_this select 0)getVariable['objectLocked',false])&&!lwyw&&!konq},{konq=true;private["_ydxe","_pkvz","_fdkn","_jryt"];_ydxe={[20,"Unlocking Object %1",[(_this select 0)],{(_this select 0)setVariable['objectLocked',false,true];konq=false;rwbh=[player,_this select 0,false];publicVariableServer"rwbh";if((_this select 0)isKindOf"Reammobox_F")then{jped call fugq}},{konq=false}]call byng};_pkvz=[(_this select 0)getVariable'objectOwner']call fqef;if(isNull _pkvz||_pkvz==player||_pkvz in units group player)then{[(_this select 0)]call _ydxe}else{[getPosATL(_this select 0),100,_pkvz,[(_this select 0),_ydxe],{_fdkn=_this select 0;_jryt=_this select 1 select 0;_ydxe=_this select 1 select 1;if(_fdkn=="ENEMY")then{[_jryt]call _ydxe}else{hint'The owner, or allied units are in the area. Eliminate them before moving this object.';konq=false}}]call zazy}},-1,5]call hzak;['beforeMove',{!((_this select 0)getVariable['objectLocked',false])}]call b_fnc_wx;['releasedVehicle',{(_this select 1)call ozum}]call b_fnc_wx;['unloadedItem',{(_this select 0)call ozum}]call b_fnc_wx;['objectLoadedIn',{(_this select 0)call ozum}]call b_fnc_wx;['beforeReleaseObject',{if((_this select 0)isKindOf"Reammobox_F")then{[_this select 0,[0,0,0]]call rmsp};nil}]call b_fnc_wx};