if(isdedicated)exitwith{false};private["_sgrp","_mgrw","_arzr","_zadm","_arzr","_ieed","_kqrc","_pmsb","_norf","_cmnm","_slea","_sqkh","_isot"];_sgrp=[_this,0,"",[""]]call jdly;_mgrw=_sgrp call wsvj;_arzr=[_this,1,true,[true]]call jdly;_zadm=[_this,2,0,[0]]call jdly;_arzr=_arzr&&(servertime - _zadm<1);_ieed=+(missionnamespace getvariable[_mgrw,[["",""],[],["","",""],objnull,"CREATED",-1]]);_kqrc=_ieed select 0;_pmsb=_ieed select 1;_norf=_ieed select 2;_cmnm=_ieed select 3;_slea=_ieed select 4;_sqkh=_ieed select 5;_isot=[];{private["_case"];_case=_x;switch(typename _case)do{case(typename""):{private["_fdoz"];_fdoz=missionnamespace getvariable[_case,objnull];_isot set[count _isot,_fdoz]};case(typename grpnull):{_isot=_isot+units _case};case(typename sideunknown):{{if((_x call bis_fnc_objectside)==_case)then{_isot set[count _isot,_x]}}foreach(allunits+alldead)};case(typename[]):{_isot=_isot+_case};case(typename true):{if(_case)then{_isot=_isot+([]call bis_fnc_listplayers)}}}}foreach _pmsb;{private["_xtext"];_xtext=_x select 0;_norf set[_foreachindex,format _x]}foreach _norf;private["_pvmx"];_pvmx=if(count _cmnm==2)then{if(isnull(_cmnm select 0))then{{}}else{{_dpgz setsimpletasktarget _cmnm}}}else{{_dpgz setsimpletaskdestination _cmnm}};private["_vzjj"];_vzjj=if(_slea=="ASSIGNED")then{{_x setcurrenttask _dpgz}}else{{_dpgz settaskstate _slea}};private["_bndu"];_bndu=[];{if(!(_x in _bndu)&&!isnull _x)then{private["_dpgz"];_dpgz=_x getvariable _mgrw;_gxod=if(isnil{_dpgz})then{private["_bgjm","_mzno","_xtasks"];_bgjm=(_kqrc select 1)call wsvj;_mzno=_x getvariable[_bgjm,tasknull];_dpgz=_x createSimpleTask[_sgrp,_mzno];_x setvariable[_mgrw,_dpgz];_xtasks=_x getvariable["BL_fnc_setTaskLocal_tasks",[]];_xtasks set[count _xtasks,_sgrp];_x setvariable["BL_fnc_setTaskLocal_tasks",_xtasks];""}else{taskstate _dpgz};if(_x==player&&_arzr)then{if(_slea=="CREATED"&&_gxod!="")exitwith{};if(_slea!=_gxod)then{[_slea,_norf]call dhny}};_dpgz setsimpletaskdescription _norf;call _pvmx;call _vzjj;if(_gxod=="ASSIGNED"&&toupper _slea in["SUCCEEDED","FAILED","CANCELED"])then{private["_znpo","_jhkd"];_znpo=-1;_jhkd="";{private["_xvar","_xdata","_xstate"];_xvar=_x call wsvj;_xdata=+(missionnamespace getvariable[_xvar,[["",""],[],["","",""],objnull,"CREATED",-1]]);_xstate=_xdata select 4;if!((toupper _xstate)in["SUCCEEDED","FAILED","CANCELED"])then{private["_xprio"];_xprio=_xdata select 5;if(_xprio>_znpo)then{_jhkd=_x;_znpo=_xprio}}}foreach(_x getvariable["BL_fnc_setTaskLocal_tasks",[]]);if(_jhkd!="")then{[_jhkd,nil,nil,nil,true,nil,false]call sxgf}};_bndu set[count _bndu,_x]}}foreach _isot;true